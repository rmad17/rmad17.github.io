<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      API calls with AngularJS &middot; Tech Karma
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="/public/css/main.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,600">
  <link href='https://fonts.googleapis.com/css?family=Slabo+27px' rel='stylesheet' type='text/css'>

  <!-- Icons -->
  <!--<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">
  -->
  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body class="theme-base-0d1">

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">

  <div class="sidebar-item">
    <a href="/" title="Home"><p class="sidebar-description">rmad17's</p></a>
    <p class="sidebar-tagline"> thoughts of rmad17</p>
  </div>

  <nav class="sidebar-nav">

    

    
    
      
        
      
    
      
        
      
    
      
    
      
        
          <a class="sidebar-nav-item" href="/blog/">Blog</a>
        
      
    
  </nav>

  <div class="">

        <div class="sidebar-item social">
          
            <a href="mailto:souravbasu17@gmail.com"><i class="fa fa-envelope-square"></i></a>
          

          
            <a href="https://github.com/rmad17"><i class="fa fa-github-square"></i></a>
          

          
          <a href="https://twitter.com/rmad1717"><i class="fa fa-twitter-square"></i></a>
          

          
          <a href="https://in.linkedin.com/in/souravbasu17"><i class="fa fa-linkedin-square"></i></i></a>
          

        </div>

        <div class="sidebar-sticky">
          <p>
            &copy; 2016. All rights reserved.
          </p>
        </div>

    </div>

</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <div>
            <img class="circular-image" src="/public/images/me.jpeg" alt="" />
          </div>
          <div>
            <h3 class="masthead-title xxlarge-header">
              <a href="/" title="Home">Tech Karma</a>
              <small>yet another developer blog</small>
            </h3>
          </div>
        </div>
      </div>

      <div class="container content">
        <div class="post">
  <h1 class="post-title">API calls with AngularJS</h1>
  <span class="post-date">02 Apr 2016</span>
  <h4>How it all started:</h4>

<p>Few days ago I wanted to learn <a href="https://angularjs.org/">AngularJS</a>. So I decided to start on building a small app with <a href="https://news.ycombinator.com/">Hacker News</a> <a href="https://github.com/HackerNews/API">APIs</a>.
So I started with the <a href="https://github.com/angular/angular-seed">Angular Seed Project</a>. I read a little bit in the angularjs documentation to get a little idea.</p>

<h4>Objective:</h4>

<p>Render the top 20 <code>new stories</code> and <code>top stories</code> from HackerNews.</p>

<hr>

<h4>How I realized the problem:</h4>

<p>However very soon I was stuck with making an API call. Most of the examples I felt were not complete. Countless googling, reading blogs and a few days later I figured why where I went wrong. The problem was that none of the examples I found made it extremely simple for a newbie user. I for one ain&#39;t an expert in Javascript. I know nothing about a front-end framework.</p>

<p>Assuming you have read about <a href="https://docs.angularjs.org/guide/controller">Controllers</a>, <a href="https://docs.angularjs.org/guide/providers">Factories</a> and <a href="https://docs.angularjs.org/guide/services">Services</a> I will skip them. if you have not read about them I suggest you do read them first.</p>

<h4>How I solved it:</h4>

<p>I used the <a href="https://github.com/angular/angular-seed">angular-seed</a> project to get started. It uses bower and npm together. In case you are not aware of bower, its just another package manager in the incredibly fragmented Javascript world.
To declare any element as <code>ng-app</code> means that element is the portion of the code where the angular application can perform any action.
<br>I declare my ng-app with the <html> tag like this:
<br>
<code>html
&lt;html lang=&quot;en&quot; ng-app=&quot;myApp&quot; class=&quot;no-js&quot;&gt;
</code>
I broke down the two views into view1 and view2 and used <code>ng-include</code> to inject them.
<br></p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container-fluid"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-md-10"</span> <span class="na">ng-include=</span><span class="s">"'./view1/view1.html'"</span><span class="nt">&gt;&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-md-10"</span> <span class="na">ng-include=</span><span class="s">"'./view2/view2.html'"</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div>
<p>Going inside view1 which is a directory located in <code>app/view1</code> we have a <code>view1_test.js</code>, <code>view1.html</code> and <code>view1.js</code>. In this article we will focus on only <code>view1.html</code>. Lets dive into the code of <code>view1.html</code>.</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;div</span>  <span class="na">ng-controller =</span><span class="err"> </span><span class="s">"nsCtrl"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div>
<p>I also created two files called <code>controllers.js</code> and <code>factories.js</code> inside <code>app/js</code>. Its declared in <code>index.html</code> as</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"app.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"js/controllers.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"js/factories.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"view1/view1.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre></div>
<p>Initially I had written all the js code in <code>app.js</code>. However after managing to figure out things I decided to make the code a bit cleaner and separation of concerns.
<br>When the html code invokes the controller <code>nsCtrl</code> it runs the controller from <code>controllers.js</code></p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
  <span class="s1">'use strict'</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">'myApp'</span><span class="p">);</span>

    <span class="nx">app</span><span class="p">.</span>
    <span class="c1">//define controller</span>
    <span class="c1">// New Stories</span>
    <span class="nx">controller</span><span class="p">(</span><span class="s1">'nsCtrl'</span><span class="p">,[</span><span class="s1">'nsFactory'</span><span class="p">,</span><span class="s1">'$scope'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">nsFactory</span><span class="p">,</span> <span class="nx">$scope</span><span class="p">){</span>
        <span class="nx">nsFactory</span><span class="p">.</span><span class="nx">getNewStories</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">){</span>
            <span class="nx">$scope</span><span class="p">.</span><span class="nx">nsitems</span> <span class="o">=</span> <span class="nx">response</span><span class="p">;</span> <span class="c1">//Assign data received to $scope.data</span>
        <span class="p">});</span>
    <span class="p">}]);</span>
<span class="p">})();</span>
</code></pre></div>
<p>The <code>nsCtrl</code> controller calls <code>nsFactory</code> method <code>getNewStories</code>.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
  <span class="s1">'use strict'</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">'myApp'</span><span class="p">);</span>

    <span class="nx">app</span>
    <span class="c1">// New Stories</span>
    <span class="p">.</span><span class="nx">factory</span><span class="p">(</span><span class="s1">'nsFactory'</span><span class="p">,[</span><span class="s1">'$http'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">$http</span><span class="p">){</span>
        <span class="kd">var</span> <span class="nx">ids</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="kd">var</span> <span class="nx">nsList</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="na">getNewStories</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>
                <span class="k">return</span>  <span class="nx">$http</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'https://hacker-news.firebaseio.com/v0/newstories.json?print=pretty'</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">){</span> <span class="c1">//wrap it inside another promise using then</span>
                            <span class="nx">ids</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
                            <span class="kd">var</span> <span class="nx">getStoryDetails</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">){</span>
                                <span class="kd">var</span> <span class="nx">u1</span> <span class="o">=</span> <span class="s1">'https://hacker-news.firebaseio.com/v0/item/'</span><span class="p">;</span>
                                <span class="kd">var</span> <span class="nx">u2</span> <span class="o">=</span> <span class="nx">id</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
                                <span class="kd">var</span> <span class="nx">u3</span> <span class="o">=</span> <span class="s1">'.json?print=pretty'</span><span class="p">;</span>
                                <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">u1</span> <span class="o">+</span> <span class="nx">u2</span> <span class="o">+</span> <span class="nx">u3</span><span class="p">;</span>
                                <span class="k">return</span>  <span class="nx">$http</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">url</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//wrap it inside another promise using then</span>
                                        <span class="nx">nsList</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
                                        <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>  <span class="c1">//only return friends</span>
                                <span class="p">});</span>
                            <span class="p">};</span>
                            <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
                                <span class="nx">getStoryDetails</span><span class="p">(</span><span class="nx">ids</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
                            <span class="p">}</span>
                            <span class="k">return</span> <span class="nx">nsList</span><span class="p">;</span>
                <span class="p">});</span>
        <span class="p">}}}])</span>
<span class="p">})();</span>
</code></pre></div>
<p>To get the list of new stories from hacker-news we call need to utilize two APIs. The first one returns an array  of new stories with id(with a length of 500). The second one with an id returns a story.
The <code>getNewStories</code> method calls the first API and then iterates through the array to get each story object and store it in an array called <code>nsList</code>. The factory functions then return the list to the controller using <code>$scope</code>.
In view1.html now we utilise the data received by the controller by inserting the following as shown.</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;div</span>  <span class="na">ng-controller =</span><span class="err"> </span><span class="s">"nsCtrl"</span><span class="nt">&gt;</span>
 <span class="nt">&lt;h3&gt;</span> New Stories <span class="nt">&lt;/h3&gt;</span>
 <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">"table"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;tr</span> <span class="na">class=</span><span class="s">"table-striped"</span> <span class="na">ng-repeat =</span><span class="err"> </span><span class="s">"nsitem in nsitems"</span><span class="nt">&gt;</span>
       <span class="nt">&lt;td&gt;</span> <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">""</span><span class="nt">&gt;</span> <span class="nt">&lt;/a&gt;</span> <span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
 <span class="nt">&lt;/table&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div>
<p>Finally, we use <code>ng-repeat</code> to iterate through the list and use each item to print the url and title.
I used the same concept in case of <code>view2</code> where I populate with <code>Top Stories</code>.</p>

<p>Thats it! Tweet and tell me if I managed to make your life easy.</p>

<p><br> For reference to the full code look at  <a href="https://github.com/rmad17/angular-yc-news">https://github.com/rmad17/angular-yc-news</a>.</p>

</div>
<a href="https://twitter.com/share" class="twitter-share-button" data-via="rmad1717">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

<div class="related">
  <h3>Related Posts</h3>
  <ul class="related-posts">
    
      <li>
        <h4>
          <a href="/2014/01/02/introducing-lanyon/">
            Introducing Lanyon
            <small>02 Jan 2014</small>
          </a>
        </h4>
      </li>
    
      <li>
        <h4>
          <a href="/2014/01/01/example-content/">
            Example content
            <small>01 Jan 2014</small>
          </a>
        </h4>
      </li>
    
      <li>
        <h4>
          <a href="/2013/12/31/whats-jekyll/">
            What's Jekyll?
            <small>31 Dec 2013</small>
          </a>
        </h4>
      </li>
    
  </ul>
</div>
<div class="comments">
    <div id="disqus_thread"></div>
    <script>
        /**
         *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
         *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
         */
        
        var disqus_config = function () {
            //var disqus_developer = 1; // Comment out when the site is live
            this.page.url = "http://souravbasu.com/2016/04/02/api-calls-with-angularjs/"; //PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
            this.page.identifier = "/2016/04/02/api-calls-with-angularjs"; //PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
        };
        
        (function() {  // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');
            
            s.src = '//souravbasu.disqus.com/embed.js';
            
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
</div>


      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>
    <div id="google-analytics">
<script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-75073467-1', 'auto');
      ga('send', 'pageview');

    </script>	
</div>

  </body>
</html>
